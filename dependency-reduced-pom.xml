<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>pt.isep</groupId>
  <artifactId>bookmarkscc</artifactId>
  <version>1.0.0</version>
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.13.0</version>
        <configuration>
          <release>${maven.compiler.release}</release>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.openjfx</groupId>
        <artifactId>javafx-maven-plugin</artifactId>
        <version>0.0.8</version>
        <configuration>
          <mainClass>pt.isep.bookmarkscc.App</mainClass>
          <jvmArgs>
            <jvmArg>-Djava.library.path=${pteid.lib.path}</jvmArg>
          </jvmArgs>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-shade-plugin</artifactId>
        <version>3.6.0</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>shade</goal>
            </goals>
            <configuration>
              <filters>
                <filter>
                  <artifact>*:*</artifact>
                  <excludes>
                    <exclude>META-INF/*.SF</exclude>
                    <exclude>META-INF/*.DSA</exclude>
                    <exclude>META-INF/*.RSA</exclude>
                  </excludes>
                </filter>
              </filters>
              <transformers>
                <transformer>
                  <mainClass>pt.isep.bookmarkscc.App</mainClass>
                </transformer>
              </transformers>
              <finalName>${project.artifactId}-${project.version}-all</finalName>
              <shadedArtifactAttached>false</shadedArtifactAttached>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>exec-maven-plugin</artifactId>
        <version>3.4.1</version>
      </plugin>
    </plugins>
  </build>
  <profiles>
    <profile>
      <id>dist</id>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>exec-maven-plugin</artifactId>
            <executions>
              <execution>
                <id>mk-app-dir</id>
                <phase>package</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>bash</executable>
                  <arguments>
                    <argument>-lc</argument>
                    <argument>mkdir -p "/home/pr/bookmarkscc/target/app"</argument>
                  </arguments>
                </configuration>
              </execution>
              <execution>
                <id>copy-main-jar</id>
                <phase>package</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>bash</executable>
                  <arguments>
                    <argument>-lc</argument>
                    <argument>cp "/home/pr/bookmarkscc/target/bookmarkscc-1.0.0-all.jar" \
                         "/home/pr/bookmarkscc/target/app/bookmarkscc-1.0.0-all.jar"</argument>
                  </arguments>
                </configuration>
              </execution>
              <execution>
                <id>copy-javafx-jars</id>
                <phase>package</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>bash</executable>
                  <arguments>
                    <argument>-lc</argument>
                    <argument>mkdir -p "/home/pr/bookmarkscc/target/app/javafx" &amp;&amp;
                      cp "$HOME/.m2/repository/org/openjfx/javafx-base/21.0.4/javafx-base-21.0.4-linux.jar" "/home/pr/bookmarkscc/target/app/javafx/" &amp;&amp;
                      cp "$HOME/.m2/repository/org/openjfx/javafx-graphics/21.0.4/javafx-graphics-21.0.4-linux.jar" "/home/pr/bookmarkscc/target/app/javafx/" &amp;&amp;
                      cp "$HOME/.m2/repository/org/openjfx/javafx-controls/21.0.4/javafx-controls-21.0.4-linux.jar" "/home/pr/bookmarkscc/target/app/javafx/" &amp;&amp;
                      cp "$HOME/.m2/repository/org/openjfx/javafx-fxml/21.0.4/javafx-fxml-21.0.4-linux.jar" "/home/pr/bookmarkscc/target/app/javafx/"</argument>
                  </arguments>
                </configuration>
              </execution>
              <execution>
                <id>copy-pteid-jar</id>
                <phase>package</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>bash</executable>
                  <arguments>
                    <argument>-lc</argument>
                    <argument>cp "/usr/local/lib/pteid_jni/pteidlibj.jar" "/home/pr/bookmarkscc/target/app/pteidlibj.jar"</argument>
                  </arguments>
                </configuration>
              </execution>
              <execution>
                <id>jpackage-deb</id>
                <phase>package</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>jpackage</executable>
                  <arguments>
                    <argument>--type</argument>
                    <argument>deb</argument>
                    <argument>--name</argument>
                    <argument>BookmarksCC</argument>
                    <argument>--app-version</argument>
                    <argument>1.0.0</argument>
                    <argument>--vendor</argument>
                    <argument>ISEP</argument>
                    <argument>--input</argument>
                    <argument>/home/pr/bookmarkscc/target/app</argument>
                    <argument>--main-jar</argument>
                    <argument>bookmarkscc-1.0.0-all.jar</argument>
                    <argument>--main-class</argument>
                    <argument>pt.isep.bookmarkscc.App</argument>
                    <argument>--install-dir</argument>
                    <argument>/opt/bookmarkscc</argument>
                    <argument>--linux-package-name</argument>
                    <argument>bookmarkscc</argument>
                    <argument>--linux-shortcut</argument>
                    <argument>--linux-menu-group</argument>
                    <argument>Utility</argument>
                    <argument>--linux-package-deps</argument>
                    <argument>pcscd,libpcsclite1</argument>
                    <argument>--java-options</argument>
                    <argument>-Djava.library.path=/usr/local/lib:/usr/local/lib/pteid_jni</argument>
                    <argument>--java-options</argument>
                    <argument>--module-path=$APPDIR/javafx</argument>
                    <argument>--java-options</argument>
                    <argument>--add-modules=javafx.controls,javafx.fxml</argument>
                    <argument>--resource-dir</argument>
                    <argument>/home/pr/bookmarkscc/src/main/jpackage</argument>
                    <argument>--dest</argument>
                    <argument>/home/pr/bookmarkscc/target/dist</argument>
                  </arguments>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>
  <dependencies>
    <dependency>
      <groupId>pt.gov</groupId>
      <artifactId>pteidlibj</artifactId>
      <version>local</version>
      <scope>system</scope>
      <systemPath>${pteid.jar}</systemPath>
    </dependency>
  </dependencies>
  <properties>
    <maven.compiler.release>21</maven.compiler.release>
    <pteid.lib.path>/usr/local/lib:/usr/local/lib/pteid_jni</pteid.lib.path>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <javafx.version>21.0.4</javafx.version>
    <linux.menu.group>Utility</linux.menu.group>
    <app.name>BookmarksCC</app.name>
    <app.vendor>ISEP</app.vendor>
    <app.install.dir>/opt/bookmarkscc</app.install.dir>
    <linux.package.name>bookmarkscc</linux.package.name>
    <linux.deps>pcscd,libpcsclite1</linux.deps>
    <pteid.jar>/usr/local/lib/pteid_jni/pteidlibj.jar</pteid.jar>
  </properties>
</project>
